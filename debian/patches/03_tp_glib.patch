=== modified file 'configure.ac'
--- configure.ac	2009-12-08 13:36:06 +0000
+++ configure.ac	2009-12-08 13:40:34 +0000
@@ -37,10 +37,10 @@
 AC_SUBST(APPLET_LIBS)
 
 DBUSMENUGLIB_REQUIRED_VERSION=0.1.1
-LIBEMPATHY_REQUIRED_VERSION=2.27.0
+TELEPATHYGLIB_REQUIRED_VERSION=0.9.0
 
 PKG_CHECK_MODULES(STATUSSERVICE, dbusmenu-glib >= $DBUSMENUGLIB_REQUIRED_VERSION
-                                 libempathy >= $LIBEMPATHY_REQUIRED_VERSION)
+                                 telepathy-glib >= $TELEPATHYGLIB_REQUIRED_VERSION)
 
 AC_SUBST(STATUSERVICE_CFLAGS)
 AC_SUBST(STATUSERVICE_LIBS)

=== modified file 'src/status-provider-mc5.c'
--- src/status-provider-mc5.c	2009-12-08 13:38:42 +0000
+++ src/status-provider-mc5.c	2009-12-08 13:46:07 +0000
@@ -24,7 +24,7 @@
 #include "config.h"
 #endif
 
-#include "libempathy/empathy-account-manager.h"
+#include "telepathy-glib/account-manager.h"
 
 #include "status-provider.h"
 #include "status-provider-mc5.h"
@@ -267,7 +267,7 @@
 
 	build_eam(STATUS_PROVIDER_MC5(sp));
 
-	empathy_account_manager_request_global_presence(priv->manager, sp_to_tp_map[status], sp_to_mc_map[status], "");
+	tp_account_manager_set_all_requested_presences(priv->manager, sp_to_tp_map[status], sp_to_mc_map[status], "");
 
 	return;
 }

